# @airent/prisma

Airent Prisma Plugin - Automatically generate Airent schema and data loaders with Prisma.js

## Why do you need this?

- It can automatically generate Airent schema YAML definitions from your Prisma schema definitions. You will not have to copy the primitive or association fields from your Prisma schema any more!
- It can automatically generate Airent data loaders for your entities so you don't need to write any data-level code at all!

## Getting Started

### Installation

First, install with npm:

```bash
npm install @airent/prisma
```

Then, update the configuration file `airent.config.js` with the following command:

```bash
npx airent-prisma
```

### Generate Airent schema YAML definitions

Every time after you update your Prisma schema, you can run the following command to update your Airent schema YAML definitions:

```bash
npx airent-prisma generate
```

This will generate the Airent schema YAML definitions in `node_modules/.airent`. Make sure you always run this command before you run `npx airent` to generate your Typescript code.

#### Simplify your entity schema

Review primitive and association fields in your existing entity schema, and you can safely remove the fields that are already defined in your Prisma DBML files. You may also remove the `model` and some `types` from your entity schema, as they will be automatically generated by Airent-Prisma.

#### Customize your entity schemas

For primitive and association fields, you may customize the defalut behavior they get ported from your Prisma schema to your Airent schema. You can specifiy `skip` to skip the fields, `internal` to make the fields internal, or `external` to make the fields presentable in field requests and responses. For example, the following lines in `airent.config.json` will ensure all primitive fields are generated as external fields and skip all the association fields:

```json
{
  "prisma": {
    "primitiveFields": "external",
    "associationFields": "skip"
  }
}
```

If you would like to override the above default behavior for certain fields in your entity schema, you may add these lines to your entity schema:

```yaml
prisma:
  skipFields:
    - field1
  internalFields:
    - field2
  externalFields:
    - field3
```

In addition, if you want to mark certain primitive or association fields deprecated, you may add these lines to your entity schema:

```yaml
prisma:
  deprecatedFields:
    - field1
    - field2
```

This is it. Have fun!
